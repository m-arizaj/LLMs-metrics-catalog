"use strict";(self.webpackChunkll_ms_metrics_catalog=self.webpackChunkll_ms_metrics_catalog||[]).push([[9404],{3555:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"metrics/generative/fd","title":"FD","description":"Introduction","source":"@site/docs/metrics/generative/fd.md","sourceDirName":"metrics/generative","slug":"/metrics/generative/fd","permalink":"/LLMs-metrics-catalog/metrics/generative/fd","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"fd","title":"FD","sidebar_label":"FD (Fr\xe9chet Distance)"},"sidebar":"docsSidebar","previous":{"title":"Density","permalink":"/LLMs-metrics-catalog/metrics/generative/density"},"next":{"title":"FLS (Feature Likelihood Score)","permalink":"/LLMs-metrics-catalog/metrics/generative/fls"}}');var s=n(4848),r=n(8453);const a={id:"fd",title:"FD",sidebar_label:"FD (Fr\xe9chet Distance)"},l=void 0,d={},c=[{value:"Introduction",id:"introduction",level:2},{value:"1. Fr\xe9chet Distance (FD / FID)",id:"1-fr\xe9chet-distance-fd--fid",level:2},{value:"Definition",id:"definition",level:3},{value:"Purpose",id:"purpose",level:3},{value:"Applications",id:"applications",level:3},{value:"Benchmarks",id:"benchmarks",level:3},{value:"Limitations",id:"limitations",level:3},{value:"2. FD\u221e (Fr\xe9chet Distance Infinite)",id:"2-fd-fr\xe9chet-distance-infinite",level:2},{value:"Definition",id:"definition-1",level:3},{value:"Advantages",id:"advantages",level:3},{value:"Limitations",id:"limitations-1",level:3},{value:"3. sFID (Spatial FID)",id:"3-sfid-spatial-fid",level:2},{value:"Definition",id:"definition-2",level:3},{value:"Purpose",id:"purpose-1",level:3},{value:"Limitations",id:"limitations-2",level:3},{value:"4. Comparative Summary",id:"4-comparative-summary",level:2},{value:"References",id:"references",level:2}];function o(e){const i={a:"a",annotation:"annotation",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",msubsup:"msubsup",msup:"msup",ol:"ol",p:"p",semantics:"semantics",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.h2,{id:"introduction",children:"Introduction"}),"\n",(0,s.jsxs)(i.p,{children:["The ",(0,s.jsx)(i.strong,{children:"Fr\xe9chet Distance (FD)"})," is one of the most widely used metrics for evaluating the quality of generative models, particularly in image generation. It is designed to measure the similarity between the distribution of generated samples and the distribution of real samples."]}),"\n",(0,s.jsx)(i.p,{children:"The metric follows a two-step process:"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Feature Extraction:"}),' Samples from both the real and generated datasets are passed through a feature extractor (an "encoder") to get lower-dimensional representations.']}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Distance Calculation:"})," The Fr\xe9chet distance (also known as the Wasserstein-2 distance) is calculated between two multivariate Gaussian distributions that are fitted to the mean and covariance of these extracted features."]}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["This metric is most commonly known as ",(0,s.jsx)(i.strong,{children:"FID (Fr\xe9chet Inception Distance)"}),", which specifically refers to using the ",(0,s.jsx)(i.strong,{children:"Inception-V3"})," network as the feature extractor. While FID is a standard, it is known to have flaws, such as a poor correlation with human perception of realism and biases from its encoder. This has led to the development of variants like ",(0,s.jsx)(i.strong,{children:"FD\u221e"})," (to correct for sample bias) and the use of ",(0,s.jsx)(i.strong,{children:"FD"})," with alternative encoders (like DINOv2)."]}),"\n",(0,s.jsx)(i.h2,{id:"1-fr\xe9chet-distance-fd--fid",children:"1. Fr\xe9chet Distance (FD / FID)"}),"\n",(0,s.jsx)(i.h3,{id:"definition",children:"Definition"}),"\n",(0,s.jsxs)(i.p,{children:["The standard Fr\xe9chet Distance. When the ",(0,s.jsx)(i.strong,{children:"Inception-V3"})," encoder is used, this metric is specifically referred to as ",(0,s.jsx)(i.strong,{children:"FID"}),". The metric computes the Wasserstein-2 distance between two Gaussians fitted to the sample mean (",(0,s.jsx)(i.span,{className:"katex",children:(0,s.jsx)(i.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,s.jsxs)(i.semantics,{children:[(0,s.jsx)(i.mrow,{children:(0,s.jsx)(i.mi,{children:"\u03bc"})}),(0,s.jsx)(i.annotation,{encoding:"application/x-tex",children:"\\mu"})]})})}),") and covariance (",(0,s.jsx)(i.span,{className:"katex",children:(0,s.jsx)(i.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,s.jsxs)(i.semantics,{children:[(0,s.jsx)(i.mrow,{children:(0,s.jsx)(i.mi,{mathvariant:"normal",children:"\u03a3"})}),(0,s.jsx)(i.annotation,{encoding:"application/x-tex",children:"\\Sigma"})]})})}),") of the real (",(0,s.jsx)(i.span,{className:"katex",children:(0,s.jsx)(i.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,s.jsxs)(i.semantics,{children:[(0,s.jsx)(i.mrow,{children:(0,s.jsx)(i.mi,{children:"r"})}),(0,s.jsx)(i.annotation,{encoding:"application/x-tex",children:"r"})]})})}),") and generated (",(0,s.jsx)(i.span,{className:"katex",children:(0,s.jsx)(i.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,s.jsxs)(i.semantics,{children:[(0,s.jsx)(i.mrow,{children:(0,s.jsx)(i.mi,{children:"g"})}),(0,s.jsx)(i.annotation,{encoding:"application/x-tex",children:"g"})]})})}),") feature representations."]}),"\n",(0,s.jsx)(i.span,{className:"katex",children:(0,s.jsx)(i.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,s.jsxs)(i.semantics,{children:[(0,s.jsxs)(i.mrow,{children:[(0,s.jsx)(i.mi,{children:"F"}),(0,s.jsx)(i.mi,{children:"D"}),(0,s.jsx)(i.mo,{children:"="}),(0,s.jsx)(i.mi,{mathvariant:"normal",children:"\u2223"}),(0,s.jsx)(i.mi,{mathvariant:"normal",children:"\u2223"}),(0,s.jsxs)(i.msub,{children:[(0,s.jsx)(i.mi,{children:"\u03bc"}),(0,s.jsx)(i.mi,{children:"r"})]}),(0,s.jsx)(i.mo,{children:"\u2212"}),(0,s.jsxs)(i.msub,{children:[(0,s.jsx)(i.mi,{children:"\u03bc"}),(0,s.jsx)(i.mi,{children:"g"})]}),(0,s.jsx)(i.mi,{mathvariant:"normal",children:"\u2223"}),(0,s.jsxs)(i.msubsup,{children:[(0,s.jsx)(i.mi,{mathvariant:"normal",children:"\u2223"}),(0,s.jsx)(i.mn,{children:"2"}),(0,s.jsx)(i.mn,{children:"2"})]}),(0,s.jsx)(i.mo,{children:"+"}),(0,s.jsx)(i.mi,{children:"T"}),(0,s.jsx)(i.mi,{children:"r"}),(0,s.jsx)(i.mo,{stretchy:"false",children:"("}),(0,s.jsxs)(i.msub,{children:[(0,s.jsx)(i.mi,{mathvariant:"normal",children:"\u03a3"}),(0,s.jsx)(i.mi,{children:"r"})]}),(0,s.jsx)(i.mo,{children:"+"}),(0,s.jsxs)(i.msub,{children:[(0,s.jsx)(i.mi,{mathvariant:"normal",children:"\u03a3"}),(0,s.jsx)(i.mi,{children:"g"})]}),(0,s.jsx)(i.mo,{children:"\u2212"}),(0,s.jsx)(i.mn,{children:"2"}),(0,s.jsx)(i.mo,{stretchy:"false",children:"("}),(0,s.jsxs)(i.msub,{children:[(0,s.jsx)(i.mi,{mathvariant:"normal",children:"\u03a3"}),(0,s.jsx)(i.mi,{children:"r"})]}),(0,s.jsxs)(i.msub,{children:[(0,s.jsx)(i.mi,{mathvariant:"normal",children:"\u03a3"}),(0,s.jsx)(i.mi,{children:"g"})]}),(0,s.jsxs)(i.msup,{children:[(0,s.jsx)(i.mo,{stretchy:"false",children:")"}),(0,s.jsxs)(i.mfrac,{children:[(0,s.jsx)(i.mn,{children:"1"}),(0,s.jsx)(i.mn,{children:"2"})]})]}),(0,s.jsx)(i.mo,{stretchy:"false",children:")"})]}),(0,s.jsx)(i.annotation,{encoding:"application/x-tex",children:"FD = ||\\mu_{r}-\\mu_{g}||_{2}^{2}+Tr(\\Sigma_{r}+\\Sigma_{g}-2(\\Sigma_{r}\\Sigma_{g})^{\\frac{1}{2}})"})]})})}),"\n",(0,s.jsx)(i.h3,{id:"purpose",children:"Purpose"}),"\n",(0,s.jsxs)(i.p,{children:["FD (and FID) is used as a primary metric for ",(0,s.jsx)(i.strong,{children:"ranking the overall quality of generative models"}),". It groups both the ",(0,s.jsx)(i.strong,{children:"fidelity"})," (realism) and ",(0,s.jsx)(i.strong,{children:"diversity"})," of the generated samples into a single score. A lower score indicates that the two distributions are more similar, implying a better-performing model."]}),"\n",(0,s.jsx)(i.h3,{id:"applications",children:"Applications"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Generative Models / Image Generation [User provided data]"}),"\n",(0,s.jsx)(i.li,{children:"Ranking generative models"}),"\n",(0,s.jsx)(i.li,{children:"Diagnosing fidelity and diversity (though it conflates them)"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"benchmarks",children:"Benchmarks"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"CIFAR10 [User provided data]"}),"\n",(0,s.jsx)(i.li,{children:"ImageNet1k [User provided data]"}),"\n",(0,s.jsx)(i.li,{children:"FFHQ [User provided data]"}),"\n",(0,s.jsx)(i.li,{children:"LSUN-Bedroom [User provided data]"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"limitations",children:"Limitations"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Encoder Bias (FID):"})," The standard Inception-V3 encoder is biased towards textures over shapes and features relevant to its 1k ImageNet classes, making it a poor perceptual space for other domains."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Poor Human Correlation (FID):"})," FID scores do not strongly correlate with human evaluations of perceptual realism, especially for diffusion models, which are often unfairly downranked despite high human-judged quality."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Sample Bias:"})," The FD calculation is biased by the finite number of samples used (e.g., 50k), and the true value would be lower with infinite samples."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Conflates Metrics:"})," It combines fidelity and diversity into a single score, making it difficult to debug ",(0,s.jsx)(i.em,{children:"why"})," a model is performing poorly."]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"2-fd-fr\xe9chet-distance-infinite",children:"2. FD\u221e (Fr\xe9chet Distance Infinite)"}),"\n",(0,s.jsx)(i.h3,{id:"definition-1",children:"Definition"}),"\n",(0,s.jsx)(i.p,{children:"A variant of FD designed to correct for the inherent bias introduced by using a finite number of samples."}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"FD\u221e"})," is calculated by evaluating the standard FD at multiple sample sizes (e.g., 15 intervals from 5k to 50k samples), fitting a linear trend to these data points, and extrapolating the FD value to an infinite number of samples (",(0,s.jsx)(i.span,{className:"katex",children:(0,s.jsx)(i.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,s.jsxs)(i.semantics,{children:[(0,s.jsxs)(i.mrow,{children:[(0,s.jsx)(i.mi,{children:"N"}),(0,s.jsx)(i.mo,{children:"="}),(0,s.jsx)(i.mi,{mathvariant:"normal",children:"\u221e"})]}),(0,s.jsx)(i.annotation,{encoding:"application/x-tex",children:"N=\\infty"})]})})}),")."]}),"\n",(0,s.jsx)(i.h3,{id:"advantages",children:"Advantages"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Provides a less biased estimate of the Fr\xe9chet Distance compared to the standard FD calculation."}),"\n",(0,s.jsx)(i.li,{children:"More stable with respect to the number of samples used."}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"limitations-1",children:"Limitations"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["While it has ",(0,s.jsx)(i.em,{children:"less"})," bias than standard FD, it does not ",(0,s.jsx)(i.em,{children:"completely"})," solve the problem, and the value still tends to decrease as more samples are used in the calculation."]}),"\n",(0,s.jsx)(i.li,{children:"It still relies on the same (potentially flawed) encoder as the underlying FD metric (e.g., Inception-V3)."}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"3-sfid-spatial-fid",children:"3. sFID (Spatial FID)"}),"\n",(0,s.jsx)(i.h3,{id:"definition-2",children:"Definition"}),"\n",(0,s.jsxs)(i.p,{children:["A variant of FID that computes the Fr\xe9chet Distance using representations from an ",(0,s.jsx)(i.strong,{children:"intermediate layer"})," of the Inception-V3 network (specifically, the ",(0,s.jsx)(i.code,{children:"mixed_6/conv"})," layer) instead of the final ",(0,s.jsx)(i.code,{children:"pool3"})," layer."]}),"\n",(0,s.jsx)(i.h3,{id:"purpose-1",children:"Purpose"}),"\n",(0,s.jsx)(i.p,{children:"This metric was developed to capture more spatial or textural features rather than the high-level semantic features from the final layer."}),"\n",(0,s.jsx)(i.h3,{id:"limitations-2",children:"Limitations"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"It still relies on the Inception-V3 network and its associated biases."}),"\n",(0,s.jsx)(i.li,{children:"It is not widely reported in modern papers compared to the standard FID."}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"4-comparative-summary",children:"4. Comparative Summary"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{style:{textAlign:"left"},children:"Metric"}),(0,s.jsx)(i.th,{style:{textAlign:"left"},children:"Based on"}),(0,s.jsx)(i.th,{style:{textAlign:"left"},children:"Extension Goal"}),(0,s.jsx)(i.th,{style:{textAlign:"left"},children:"Key Feature(s)"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{style:{textAlign:"left"},children:(0,s.jsx)(i.strong,{children:"FD / FID"})}),(0,s.jsx)(i.td,{style:{textAlign:"left"},children:"FD"}),(0,s.jsx)(i.td,{style:{textAlign:"left"},children:"Baseline metric for overall quality (fidelity + diversity)."}),(0,s.jsxs)(i.td,{style:{textAlign:"left"},children:[(0,s.jsx)(i.span,{className:"katex",children:(0,s.jsx)(i.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,s.jsxs)(i.semantics,{children:[(0,s.jsx)(i.mrow,{children:(0,s.jsxs)(i.msub,{children:[(0,s.jsx)(i.mi,{children:"W"}),(0,s.jsx)(i.mn,{children:"2"})]})}),(0,s.jsx)(i.annotation,{encoding:"application/x-tex",children:"W_2"})]})})})," distance between Gaussian moments. FID uses Inception-V3."]})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{style:{textAlign:"left"},children:(0,s.jsx)(i.strong,{children:"FD\u221e"})}),(0,s.jsx)(i.td,{style:{textAlign:"left"},children:"FD"}),(0,s.jsx)(i.td,{style:{textAlign:"left"},children:"Remove finite-sample bias from the FD calculation."}),(0,s.jsxs)(i.td,{style:{textAlign:"left"},children:["Extrapolates FD value to ",(0,s.jsx)(i.span,{className:"katex",children:(0,s.jsx)(i.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,s.jsxs)(i.semantics,{children:[(0,s.jsxs)(i.mrow,{children:[(0,s.jsx)(i.mi,{children:"N"}),(0,s.jsx)(i.mo,{children:"="}),(0,s.jsx)(i.mi,{mathvariant:"normal",children:"\u221e"})]}),(0,s.jsx)(i.annotation,{encoding:"application/x-tex",children:"N=\\infty"})]})})})," using a linear fit."]})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{style:{textAlign:"left"},children:(0,s.jsx)(i.strong,{children:"sFID"})}),(0,s.jsx)(i.td,{style:{textAlign:"left"},children:"FD / FID"}),(0,s.jsx)(i.td,{style:{textAlign:"left"},children:"Evaluate on spatial features, not just semantic features."}),(0,s.jsx)(i.td,{style:{textAlign:"left"},children:"Uses an intermediate layer of Inception-V3."})]})]})]}),"\n",(0,s.jsx)(i.h2,{id:"references",children:"References"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Stein, G., Cresswell, J. C., Hosseinzadeh, R., et al. (2023). ",(0,s.jsx)(i.em,{children:"Exposing flaws of generative model evaluation metrics and their unfair treatment of diffusion models"}),". ",(0,s.jsx)(i.a,{href:"https://doi.org/10.48550/arXiv.2306.04675",children:"https://doi.org/10.48550/arXiv.2306.04675"})]}),"\n",(0,s.jsxs)(i.li,{children:["Heusel, M., Ramsauer, H., Unterthiner, T., Nessler, B., & Hochreiter, S. (2017). ",(0,s.jsx)(i.em,{children:"GANs trained by a two time-scale update rule converge to a local Nash equilibrium"}),". (Cited as [48])"]}),"\n",(0,s.jsxs)(i.li,{children:["Chong, M. J., & Forsyth, D. (2020). ",(0,s.jsx)(i.em,{children:"Effectively unbiased FID and inception score and where to find them"}),". (Cited as [22])"]}),"\n",(0,s.jsxs)(i.li,{children:["Nash, C., Menick, J., Dieleman, S., & Battaglia, P. W. (2021). ",(0,s.jsx)(i.em,{children:"Generating images with sparse representations"}),". (Cited as [76])"]}),"\n",(0,s.jsx)(i.li,{children:"(Excel Data: Paper 67)"}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453:(e,i,n)=>{n.d(i,{R:()=>a,x:()=>l});var t=n(6540);const s={},r=t.createContext(s);function a(e){const i=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(r.Provider,{value:i},e.children)}}}]);