"use strict";(self.webpackChunkll_ms_metrics_catalog=self.webpackChunkll_ms_metrics_catalog||[]).push([[3566],{1375:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>o,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"metrics/code-structural/ranked-retrieval","title":"Ranked Retrieval","description":"Introduction","source":"@site/docs/metrics/code-structural/ranked-retrieval.md","sourceDirName":"metrics/code-structural","slug":"/metrics/code-structural/ranked-retrieval","permalink":"/LLMs-metrics-catalog/metrics/code-structural/ranked-retrieval","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"ranked-retrieval","title":"Ranked Retrieval","sidebar_label":"Ranked Retrieval"},"sidebar":"docsSidebar","previous":{"title":"Build Metrics","permalink":"/LLMs-metrics-catalog/metrics/code-structural/build"},"next":{"title":"Data-Flow Match","permalink":"/LLMs-metrics-catalog/metrics/code-structural/dataflow"}}');var r=i(4848),t=i(8453);const l={id:"ranked-retrieval",title:"Ranked Retrieval",sidebar_label:"Ranked Retrieval"},a=void 0,c={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Formula",id:"formula",level:2},{value:"CG@K",id:"cgk",level:3},{value:"DCG@K",id:"dcgk",level:3},{value:"NDCG@K",id:"ndcgk",level:3},{value:"Variants",id:"variants",level:2},{value:"CG Variants",id:"cg-variants",level:3},{value:"DCG Variants",id:"dcg-variants",level:3},{value:"NDCG Variants",id:"ndcg-variants",level:3},{value:"Applications in Software Engineering",id:"applications-in-software-engineering",level:2},{value:"Code Retrieval",id:"code-retrieval",level:3},{value:"Documentation Search",id:"documentation-search",level:3},{value:"Tool and Knowledge Retrieval in Agents",id:"tool-and-knowledge-retrieval-in-agents",level:3},{value:"Long-Context Retrieval",id:"long-context-retrieval",level:3},{value:"Interpretation",id:"interpretation",level:2},{value:"High CG@K",id:"high-cgk",level:3},{value:"High DCG@K",id:"high-dcgk",level:3},{value:"High NDCG@K",id:"high-ndcgk",level:3},{value:"Low NDCG@K",id:"low-ndcgk",level:3},{value:"Strengths",id:"strengths",level:3},{value:"Limitations",id:"limitations",level:3},{value:"References",id:"references",level:2}];function h(e){const n={a:"a",annotation:"annotation",br:"br",em:"em",h2:"h2",h3:"h3",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",mtext:"mtext",munderover:"munderover",ol:"ol",p:"p",semantics:"semantics",span:"span",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsx)(n.p,{children:"Ranked retrieval metrics evaluate how effectively a model orders a list of candidate items\u2014typically documents, code snippets, or retrieved facts\u2014based on relevance. In LLM evaluation, these metrics quantify ranking quality in tasks where the ordering of outputs matters."}),"\n",(0,r.jsx)(n.p,{children:"The HELM benchmark defines three key ranking metrics for Information Retrieval (IR) settings:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"CG@K (Cumulative Gain)"})," \u2014 sum of graded relevance scores for the top-",(0,r.jsx)(n.span,{className:"katex",children:(0,r.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(n.semantics,{children:[(0,r.jsx)(n.mrow,{children:(0,r.jsx)(n.mi,{children:"K"})}),(0,r.jsx)(n.annotation,{encoding:"application/x-tex",children:"K"})]})})})," items."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"DCG@K (Discounted Cumulative Gain)"})," \u2014 CG@K with rank-position discounting."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"NDCG@K (Normalized Discounted Cumulative Gain)"})," \u2014 DCG@K normalized by the ideal ordering, enabling comparison across systems."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["HELM uses ",(0,r.jsx)(n.em,{children:"NDCG@10"})," as the default accuracy metric for MS MARCO (TREC), making it a central measure for LLM-based retrieval and reranking systems."]}),"\n",(0,r.jsx)(n.h2,{id:"formula",children:"Formula"}),"\n",(0,r.jsx)(n.h3,{id:"cgk",children:"CG@K"}),"\n",(0,r.jsxs)(n.p,{children:["CG@K sums the relevance values of the top-",(0,r.jsx)(n.span,{className:"katex",children:(0,r.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(n.semantics,{children:[(0,r.jsx)(n.mrow,{children:(0,r.jsx)(n.mi,{children:"K"})}),(0,r.jsx)(n.annotation,{encoding:"application/x-tex",children:"K"})]})})})," retrieved items:"]}),"\n",(0,r.jsx)(n.span,{className:"katex",children:(0,r.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,r.jsxs)(n.semantics,{children:[(0,r.jsxs)(n.mrow,{children:[(0,r.jsx)(n.mtext,{children:"CG@K"}),(0,r.jsx)(n.mo,{children:"="}),(0,r.jsxs)(n.munderover,{children:[(0,r.jsx)(n.mo,{children:"\u2211"}),(0,r.jsxs)(n.mrow,{children:[(0,r.jsx)(n.mi,{children:"i"}),(0,r.jsx)(n.mo,{children:"="}),(0,r.jsx)(n.mn,{children:"1"})]}),(0,r.jsx)(n.mi,{children:"K"})]}),(0,r.jsx)(n.mtext,{children:"rel"}),(0,r.jsx)(n.mo,{stretchy:"false",children:"("}),(0,r.jsxs)(n.msub,{children:[(0,r.jsx)(n.mi,{children:"d"}),(0,r.jsx)(n.mi,{children:"i"})]}),(0,r.jsx)(n.mo,{stretchy:"false",children:")"})]}),(0,r.jsx)(n.annotation,{encoding:"application/x-tex",children:"\\text{CG@K}=\\sum_{i=1}^{K} \\text{rel}(d_i)"})]})})}),"\n",(0,r.jsxs)(n.p,{children:["where ",(0,r.jsx)(n.span,{className:"katex",children:(0,r.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(n.semantics,{children:[(0,r.jsxs)(n.mrow,{children:[(0,r.jsx)(n.mtext,{children:"rel"}),(0,r.jsx)(n.mo,{stretchy:"false",children:"("}),(0,r.jsxs)(n.msub,{children:[(0,r.jsx)(n.mi,{children:"d"}),(0,r.jsx)(n.mi,{children:"i"})]}),(0,r.jsx)(n.mo,{stretchy:"false",children:")"})]}),(0,r.jsx)(n.annotation,{encoding:"application/x-tex",children:"\\text{rel}(d_i)"})]})})})," is the graded relevance of document ",(0,r.jsx)(n.span,{className:"katex",children:(0,r.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(n.semantics,{children:[(0,r.jsx)(n.mrow,{children:(0,r.jsxs)(n.msub,{children:[(0,r.jsx)(n.mi,{children:"d"}),(0,r.jsx)(n.mi,{children:"i"})]})}),(0,r.jsx)(n.annotation,{encoding:"application/x-tex",children:"d_i"})]})})}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"dcgk",children:"DCG@K"}),"\n",(0,r.jsx)(n.p,{children:"DCG@K applies a logarithmic discount to lower-ranked documents:"}),"\n",(0,r.jsx)(n.span,{className:"katex",children:(0,r.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,r.jsxs)(n.semantics,{children:[(0,r.jsxs)(n.mrow,{children:[(0,r.jsx)(n.mtext,{children:"DCG@K"}),(0,r.jsx)(n.mo,{children:"="}),(0,r.jsxs)(n.munderover,{children:[(0,r.jsx)(n.mo,{children:"\u2211"}),(0,r.jsxs)(n.mrow,{children:[(0,r.jsx)(n.mi,{children:"i"}),(0,r.jsx)(n.mo,{children:"="}),(0,r.jsx)(n.mn,{children:"1"})]}),(0,r.jsx)(n.mi,{children:"K"})]}),(0,r.jsxs)(n.mfrac,{children:[(0,r.jsxs)(n.mrow,{children:[(0,r.jsx)(n.mtext,{children:"rel"}),(0,r.jsx)(n.mo,{stretchy:"false",children:"("}),(0,r.jsxs)(n.msub,{children:[(0,r.jsx)(n.mi,{children:"d"}),(0,r.jsx)(n.mi,{children:"i"})]}),(0,r.jsx)(n.mo,{stretchy:"false",children:")"})]}),(0,r.jsxs)(n.mrow,{children:[(0,r.jsxs)(n.msub,{children:[(0,r.jsxs)(n.mrow,{children:[(0,r.jsx)(n.mi,{children:"log"}),(0,r.jsx)(n.mo,{children:"\u2061"})]}),(0,r.jsx)(n.mn,{children:"2"})]}),(0,r.jsx)(n.mo,{stretchy:"false",children:"("}),(0,r.jsx)(n.mi,{children:"i"}),(0,r.jsx)(n.mo,{children:"+"}),(0,r.jsx)(n.mn,{children:"1"}),(0,r.jsx)(n.mo,{stretchy:"false",children:")"})]})]})]}),(0,r.jsx)(n.annotation,{encoding:"application/x-tex",children:"\\text{DCG@K} = \\sum_{i=1}^{K} \\frac{\\text{rel}(d_i)}{\\log_2(i+1)}"})]})})}),"\n",(0,r.jsx)(n.h3,{id:"ndcgk",children:"NDCG@K"}),"\n",(0,r.jsx)(n.p,{children:"NDCG@K normalizes the DCG score using the ideal ranking:"}),"\n",(0,r.jsx)(n.span,{className:"katex",children:(0,r.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,r.jsxs)(n.semantics,{children:[(0,r.jsxs)(n.mrow,{children:[(0,r.jsx)(n.mtext,{children:"NDCG@K"}),(0,r.jsx)(n.mo,{children:"="}),(0,r.jsxs)(n.mfrac,{children:[(0,r.jsx)(n.mtext,{children:"DCG@K"}),(0,r.jsx)(n.mtext,{children:"IDCG@K"})]})]}),(0,r.jsx)(n.annotation,{encoding:"application/x-tex",children:"\\text{NDCG@K} = \\frac{\\text{DCG@K}}{\\text{IDCG@K}}"})]})})}),"\n",(0,r.jsxs)(n.p,{children:["where ",(0,r.jsx)(n.span,{className:"katex",children:(0,r.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(n.semantics,{children:[(0,r.jsx)(n.mrow,{children:(0,r.jsx)(n.mtext,{children:"IDCG@K"})}),(0,r.jsx)(n.annotation,{encoding:"application/x-tex",children:"\\text{IDCG@K}"})]})})})," is computed by sorting the same set of relevance labels in the best possible order."]}),"\n",(0,r.jsxs)(n.p,{children:["HELM explicitly identifies ",(0,r.jsx)(n.em,{children:"NDCG@10"})," as the standard metric for MS MARCO reranking."]}),"\n",(0,r.jsx)(n.h2,{id:"variants",children:"Variants"}),"\n",(0,r.jsx)(n.h3,{id:"cg-variants",children:"CG Variants"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["*CG@1, **CG@3, *",(0,r.jsx)(n.em,{children:"CG@5"}),": measure total relevance without discounting."]}),"\n",(0,r.jsx)(n.li,{children:"Useful predominantly as baseline measures; lack position sensitivity."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"dcg-variants",children:"DCG Variants"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["*DCG@10, *",(0,r.jsx)(n.em,{children:"DCG@100"}),": extend the depth of ranking."]}),"\n",(0,r.jsxs)(n.li,{children:["Discounting base can vary, but HELM uses ",(0,r.jsx)(n.span,{className:"katex",children:(0,r.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(n.semantics,{children:[(0,r.jsxs)(n.mrow,{children:[(0,r.jsxs)(n.msub,{children:[(0,r.jsxs)(n.mrow,{children:[(0,r.jsx)(n.mi,{children:"log"}),(0,r.jsx)(n.mo,{children:"\u2061"})]}),(0,r.jsx)(n.mn,{children:"2"})]}),(0,r.jsx)(n.mo,{stretchy:"false",children:"("}),(0,r.jsx)(n.mi,{children:"i"}),(0,r.jsx)(n.mo,{children:"+"}),(0,r.jsx)(n.mn,{children:"1"}),(0,r.jsx)(n.mo,{stretchy:"false",children:")"})]}),(0,r.jsx)(n.annotation,{encoding:"application/x-tex",children:"\\log_2(i+1)"})]})})}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"ndcg-variants",children:"NDCG Variants"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"NDCG@10"}),": core metric for MS MARCO."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"NDCG@K (general)"}),": used when tasks have deeper ranking lists."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"NDCG is the most comparable and stable metric across tasks because it is normalized to the ideal ranking."}),"\n",(0,r.jsx)(n.h2,{id:"applications-in-software-engineering",children:"Applications in Software Engineering"}),"\n",(0,r.jsx)(n.h3,{id:"code-retrieval",children:"Code Retrieval"}),"\n",(0,r.jsx)(n.p,{children:"When LLMs are used to retrieve relevant code snippets or examples, NDCG@K measures how well they rank relevant code above irrelevant code."}),"\n",(0,r.jsx)(n.h3,{id:"documentation-search",children:"Documentation Search"}),"\n",(0,r.jsx)(n.p,{children:"Ranking technical documentation or API references benefits heavily from DCG/NDCG since:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"early results matter more,"}),"\n",(0,r.jsx)(n.li,{children:"relevance can be graded (fully relevant, partially relevant, etc.)."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"tool-and-knowledge-retrieval-in-agents",children:"Tool and Knowledge Retrieval in Agents"}),"\n",(0,r.jsx)(n.p,{children:"For multi-step tool-using agents, retrieval quality directly impacts subsequent action accuracy. NDCG@K measures the quality of these ranked internal searches."}),"\n",(0,r.jsx)(n.h3,{id:"long-context-retrieval",children:"Long-Context Retrieval"}),"\n",(0,r.jsx)(n.p,{children:"In SE-specific tasks involving long codebases (e.g., retrieving relevant files, modules, or functions), NDCG@K reflects how well LLMs determine importance and relevance in large candidate sets."}),"\n",(0,r.jsx)(n.h2,{id:"interpretation",children:"Interpretation"}),"\n",(0,r.jsx)(n.h3,{id:"high-cgk",children:"High CG@K"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Many retrieved items are relevant."}),"\n",(0,r.jsx)(n.li,{children:"Does not guarantee correct ordering."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"high-dcgk",children:"High DCG@K"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Relevant items appear early in the ranking."}),"\n",(0,r.jsx)(n.li,{children:"Indicates good position-aware retrieval performance."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"high-ndcgk",children:"High NDCG@K"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Ranking closely matches the ideal ranking."}),"\n",(0,r.jsx)(n.li,{children:"Indicates strong retrieval and reranking capability."}),"\n",(0,r.jsx)(n.li,{children:"Most robust measure across tasks."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"low-ndcgk",children:"Low NDCG@K"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Relevant items are misplaced in ranking."}),"\n",(0,r.jsx)(n.li,{children:"Indicates weak understanding of query relevance or ranking logic."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"strengths",children:"Strengths"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Support graded relevance rather than binary correctness."}),"\n",(0,r.jsx)(n.li,{children:"Reward early placement of high-value items."}),"\n",(0,r.jsx)(n.li,{children:"NDCG@K enables fair cross-system comparisons."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"limitations",children:"Limitations"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Require graded relevance labels."}),"\n",(0,r.jsx)(n.li,{children:"Sensitive to annotation quality."}),"\n",(0,r.jsx)(n.li,{children:"Small changes at high ranks can disproportionately affect scores."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["HELM: Holistic Evaluation of Language Models. (2023).",(0,r.jsx)(n.br,{}),"\n","Appendix C \u2014 Ranking metrics CG@K, DCG@K, NDCG@K.",(0,r.jsx)(n.br,{}),"\n","MS MARCO experiments using NDCG@10.",(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.a,{href:"https://doi.org/10.48550/arXiv.2211.09110",children:"https://doi.org/10.48550/arXiv.2211.09110"})]}),"\n"]})]})}function o(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var s=i(6540);const r={},t=s.createContext(r);function l(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);