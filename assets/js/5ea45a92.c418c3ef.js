"use strict";(self.webpackChunkll_ms_metrics_catalog=self.webpackChunkll_ms_metrics_catalog||[]).push([[8493],{2229:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>a,default:()=>m,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"metrics/generative/kernel-distance","title":"Kernel Distance (KD / KID)","description":"Definition","source":"@site/docs/metrics/generative/kernel-distance.md","sourceDirName":"metrics/generative","slug":"/metrics/generative/kernel-distance","permalink":"/LLMs-metrics-catalog/metrics/generative/kernel-distance","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"kernel-distance","title":"Kernel Distance (KD / KID)","sidebar_label":"KID"},"sidebar":"docsSidebar","previous":{"title":"Inception Score (IS)","permalink":"/LLMs-metrics-catalog/metrics/generative/inception"},"next":{"title":"MAUVE","permalink":"/LLMs-metrics-catalog/metrics/generative/mauve"}}');var r=n(4848),t=n(8453);const l={id:"kernel-distance",title:"Kernel Distance (KD / KID)",sidebar_label:"KID"},a=void 0,c={},d=[{value:"Definition",id:"definition",level:2},{value:"Formula (General Idea)",id:"formula-general-idea",level:2},{value:"Purpose",id:"purpose",level:2},{value:"Domains",id:"domains",level:2},{value:"Advantages",id:"advantages",level:2},{value:"Limitations",id:"limitations",level:2},{value:"Key References",id:"key-references",level:2}];function h(e){const s={a:"a",annotation:"annotation",em:"em",h2:"h2",hr:"hr",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",msubsup:"msubsup",msup:"msup",munderover:"munderover",p:"p",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h2,{id:"definition",children:"Definition"}),"\n",(0,r.jsxs)(s.p,{children:["The ",(0,r.jsx)(s.strong,{children:"Kernel Distance (KD)"}),", often referred to as the ",(0,r.jsx)(s.strong,{children:"Kernel Inception Distance (KID)"})," when used with the Inception-V3 network, is a metric for evaluating generative models. Introduced by Bi\u0144kowski et al. (2018), it was designed as an alternative to the Fr\xe9chet Inception Distance (FID)."]}),"\n",(0,r.jsxs)(s.p,{children:["Unlike FID, which only compares the first two moments (mean and covariance) of the real and generated distributions, KD aims to be a proper distance between the entire distributions. It does this by using an unbiased estimate of the ",(0,r.jsx)(s.strong,{children:"Maximum Mean Discrepancy (MMD)"}),"."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"formula-general-idea",children:"Formula (General Idea)"}),"\n",(0,r.jsx)(s.p,{children:"The Kernel Distance is calculated as an unbiased estimate of the MMD between the sets of real and generated samples (after being passed through an encoder):"}),"\n",(0,r.jsx)(s.span,{className:"katex",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"K"}),(0,r.jsx)(s.mi,{children:"D"}),(0,r.jsx)(s.mo,{stretchy:"false",children:"("}),(0,r.jsx)(s.mo,{stretchy:"false",children:"{"}),(0,r.jsxs)(s.msubsup,{children:[(0,r.jsx)(s.mi,{children:"x"}),(0,r.jsx)(s.mi,{children:"i"}),(0,r.jsx)(s.mi,{children:"g"})]}),(0,r.jsxs)(s.msubsup,{children:[(0,r.jsx)(s.mo,{stretchy:"false",children:"}"}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"i"}),(0,r.jsx)(s.mo,{children:"="}),(0,r.jsx)(s.mn,{children:"1"})]}),(0,r.jsx)(s.mi,{children:"n"})]}),(0,r.jsx)(s.mo,{separator:"true",children:","}),(0,r.jsx)(s.mo,{stretchy:"false",children:"{"}),(0,r.jsxs)(s.msubsup,{children:[(0,r.jsx)(s.mi,{children:"x"}),(0,r.jsx)(s.mi,{children:"j"}),(0,r.jsx)(s.mi,{children:"r"})]}),(0,r.jsxs)(s.msubsup,{children:[(0,r.jsx)(s.mo,{stretchy:"false",children:"}"}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"j"}),(0,r.jsx)(s.mo,{children:"="}),(0,r.jsx)(s.mn,{children:"1"})]}),(0,r.jsx)(s.mi,{children:"m"})]}),(0,r.jsx)(s.mo,{stretchy:"false",children:")"}),(0,r.jsx)(s.mo,{children:"="}),(0,r.jsxs)(s.mfrac,{children:[(0,r.jsx)(s.mn,{children:"1"}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"n"}),(0,r.jsx)(s.mo,{stretchy:"false",children:"("}),(0,r.jsx)(s.mi,{children:"n"}),(0,r.jsx)(s.mo,{children:"\u2212"}),(0,r.jsx)(s.mn,{children:"1"}),(0,r.jsx)(s.mo,{stretchy:"false",children:")"})]})]}),(0,r.jsxs)(s.munderover,{children:[(0,r.jsx)(s.mo,{children:"\u2211"}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"i"}),(0,r.jsx)(s.mo,{mathvariant:"normal",children:"\u2260"}),(0,r.jsxs)(s.msup,{children:[(0,r.jsx)(s.mi,{children:"i"}),(0,r.jsx)(s.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]})]}),(0,r.jsx)(s.mi,{children:"n"})]}),(0,r.jsx)(s.mi,{children:"k"}),(0,r.jsx)(s.mo,{stretchy:"false",children:"("}),(0,r.jsxs)(s.msubsup,{children:[(0,r.jsx)(s.mi,{children:"x"}),(0,r.jsx)(s.mi,{children:"i"}),(0,r.jsx)(s.mi,{children:"g"})]}),(0,r.jsx)(s.mo,{separator:"true",children:","}),(0,r.jsxs)(s.msubsup,{children:[(0,r.jsx)(s.mi,{children:"x"}),(0,r.jsxs)(s.msup,{children:[(0,r.jsx)(s.mi,{children:"i"}),(0,r.jsx)(s.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]}),(0,r.jsx)(s.mi,{children:"g"})]}),(0,r.jsx)(s.mo,{stretchy:"false",children:")"}),(0,r.jsx)(s.mo,{children:"+"}),(0,r.jsxs)(s.mfrac,{children:[(0,r.jsx)(s.mn,{children:"1"}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"m"}),(0,r.jsx)(s.mo,{stretchy:"false",children:"("}),(0,r.jsx)(s.mi,{children:"m"}),(0,r.jsx)(s.mo,{children:"\u2212"}),(0,r.jsx)(s.mn,{children:"1"}),(0,r.jsx)(s.mo,{stretchy:"false",children:")"})]})]}),(0,r.jsxs)(s.munderover,{children:[(0,r.jsx)(s.mo,{children:"\u2211"}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"j"}),(0,r.jsx)(s.mo,{mathvariant:"normal",children:"\u2260"}),(0,r.jsxs)(s.msup,{children:[(0,r.jsx)(s.mi,{children:"j"}),(0,r.jsx)(s.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]})]}),(0,r.jsx)(s.mi,{children:"m"})]}),(0,r.jsx)(s.mi,{children:"k"}),(0,r.jsx)(s.mo,{stretchy:"false",children:"("}),(0,r.jsxs)(s.msubsup,{children:[(0,r.jsx)(s.mi,{children:"x"}),(0,r.jsx)(s.mi,{children:"j"}),(0,r.jsx)(s.mi,{children:"r"})]}),(0,r.jsx)(s.mo,{separator:"true",children:","}),(0,r.jsxs)(s.msubsup,{children:[(0,r.jsx)(s.mi,{children:"x"}),(0,r.jsxs)(s.msup,{children:[(0,r.jsx)(s.mi,{children:"j"}),(0,r.jsx)(s.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]}),(0,r.jsx)(s.mi,{children:"r"})]}),(0,r.jsx)(s.mo,{stretchy:"false",children:")"}),(0,r.jsx)(s.mo,{children:"\u2212"}),(0,r.jsxs)(s.mfrac,{children:[(0,r.jsx)(s.mn,{children:"2"}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"n"}),(0,r.jsx)(s.mi,{children:"m"})]})]}),(0,r.jsxs)(s.munderover,{children:[(0,r.jsx)(s.mo,{children:"\u2211"}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"i"}),(0,r.jsx)(s.mo,{children:"="}),(0,r.jsx)(s.mn,{children:"1"})]}),(0,r.jsx)(s.mi,{children:"n"})]}),(0,r.jsxs)(s.munderover,{children:[(0,r.jsx)(s.mo,{children:"\u2211"}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"j"}),(0,r.jsx)(s.mo,{children:"="}),(0,r.jsx)(s.mn,{children:"1"})]}),(0,r.jsx)(s.mi,{children:"m"})]}),(0,r.jsx)(s.mi,{children:"k"}),(0,r.jsx)(s.mo,{stretchy:"false",children:"("}),(0,r.jsxs)(s.msubsup,{children:[(0,r.jsx)(s.mi,{children:"x"}),(0,r.jsx)(s.mi,{children:"i"}),(0,r.jsx)(s.mi,{children:"g"})]}),(0,r.jsx)(s.mo,{separator:"true",children:","}),(0,r.jsxs)(s.msubsup,{children:[(0,r.jsx)(s.mi,{children:"x"}),(0,r.jsx)(s.mi,{children:"j"}),(0,r.jsx)(s.mi,{children:"r"})]}),(0,r.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"KD(\\{x_{i}^{g}\\}_{i=1}^{n},\\{x_{j}^{r}\\}_{j=1}^{m})=\\frac{1}{n(n-1)}\\sum_{i\\ne i^{\\prime}}^{n}k(x_{i}^{g},x_{i^{\\prime}}^{g})+\\frac{1}{m(m-1)}\\sum_{j\\ne j^{\\prime}}^{m}k(x_{j}^{r},x_{j^{\\prime}}^{r})-\\frac{2}{nm}\\sum_{i=1}^{n}\\sum_{j=1}^{m}k(x_{i}^{g},x_{j}^{r})"})]})})}),"\n",(0,r.jsx)(s.p,{children:"Where:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.span,{className:"katex",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsx)(s.mrow,{children:(0,r.jsx)(s.mi,{children:"k"})}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"k"})]})})})," is a positive definite kernel, which is a hyperparameter."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.span,{className:"katex",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mo,{stretchy:"false",children:"{"}),(0,r.jsxs)(s.msubsup,{children:[(0,r.jsx)(s.mi,{children:"x"}),(0,r.jsx)(s.mi,{children:"i"}),(0,r.jsx)(s.mi,{children:"g"})]}),(0,r.jsx)(s.mo,{stretchy:"false",children:"}"})]}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\{x_{i}^{g}\\}"})]})})})," are the generated samples and ",(0,r.jsx)(s.span,{className:"katex",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mo,{stretchy:"false",children:"{"}),(0,r.jsxs)(s.msubsup,{children:[(0,r.jsx)(s.mi,{children:"x"}),(0,r.jsx)(s.mi,{children:"j"}),(0,r.jsx)(s.mi,{children:"r"})]}),(0,r.jsx)(s.mo,{stretchy:"false",children:"}"})]}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\{x_{j}^{r}\\}"})]})})})," are the real samples."]}),"\n",(0,r.jsx)(s.li,{children:"A standard 3rd degree polynomial kernel is commonly used."}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"purpose",children:"Purpose"}),"\n",(0,r.jsxs)(s.p,{children:["The primary purpose of KD/KID is to serve as a ",(0,r.jsx)(s.strong,{children:"ranking metric"})," for the overall quality of generative models. It was proposed to overcome a key limitation of FID by providing a metric that is a proper distance between distributions, not just their first two moments."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"domains",children:"Domains"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Generative Models / Image Generation"}),"\n",(0,r.jsx)(s.li,{children:"Ranking / Overall Quality"}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"advantages",children:"Advantages"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Proper Distributional Metric:"})," Unlike FD, KD is a proper distance between distributions and is not limited to comparing their first two moments."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"No Gaussian Assumption:"})," It does not assume that the feature distributions are Gaussian"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"limitations",children:"Limitations"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"High Correlation with FD:"})," Despite its different theoretical basis, KD is found to be ",(0,r.jsx)(s.strong,{children:"very highly correlated"})," with Fr\xe9chet Distance (FD) and ",(0,r.jsx)(s.span,{className:"katex",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"F"}),(0,r.jsxs)(s.msub,{children:[(0,r.jsx)(s.mi,{children:"D"}),(0,r.jsx)(s.mi,{mathvariant:"normal",children:"\u221e"})]})]}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"FD_{\\infty}"})]})})}),' across various encoders. This means it results in "essentially the same model rankings" as FD.']}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Encoder-Dependent:"})," Like FD, its correlation with human perception of quality is highly dependent on the feature extractor (encoder) used."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Poor Inception-V3 Correlation:"})," When used with the standard Inception-V3 network (as KID), the metric does ",(0,r.jsx)(s.strong,{children:"not"})," correlate well with human evaluations of image realism, particularly on complex datasets."]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"key-references",children:"Key References"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Bi\u0144kowski, M., Sutherland, D. J., Arbel, M., & Gretton, A. (2018). ",(0,r.jsx)(s.em,{children:"Demystifying MMD GANs"}),". In ",(0,r.jsx)(s.em,{children:"International Conference on Learning Representations"}),". ",(0,r.jsx)(s.a,{href:"https://doi.org/10.48550/arXiv.1801.01401",children:"https://doi.org/10.48550/arXiv.1801.01401"})]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Stein, G., Cresswell, J. C., Hosseinzadeh, R., Sui, Y., Ross, B. L., Villecroze, V., Liu, Z., Caterini, A. L., Taylor, J. E. T., & Loaiza-Ganem, G. (2023). Exposing flaws of generative model evaluation metrics and their unfair treatment of diffusion models. arXiv. ",(0,r.jsx)(s.a,{href:"https://doi.org/10.48550/arXiv.2306.04675",children:"https://doi.org/10.48550/arXiv.2306.04675"})]}),"\n"]}),"\n"]})]})}function m(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>a});var i=n(6540);const r={},t=i.createContext(r);function l(e){const s=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:s},e.children)}}}]);