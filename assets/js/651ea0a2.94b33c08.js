"use strict";(self.webpackChunkll_ms_metrics_catalog=self.webpackChunkll_ms_metrics_catalog||[]).push([[1040],{6204:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"metrics/robustness/ct-score","title":"CT Score","description":"Introduction","source":"@site/docs/metrics/robustness/ct-score.md","sourceDirName":"metrics/robustness","slug":"/metrics/robustness/ct-score","permalink":"/LLMs-metrics-catalog/metrics/robustness/ct-score","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"ct-score","title":"CT Score","sidebar_label":"CT Score"},"sidebar":"docsSidebar","previous":{"title":"Model Checking (CTL)","permalink":"/LLMs-metrics-catalog/metrics/logical/model-checking-ctl"},"next":{"title":"Fitness Function","permalink":"/LLMs-metrics-catalog/metrics/robustness/fitness"}}');var t=i(4848),r=i(8453);const a={id:"ct-score",title:"CT Score",sidebar_label:"CT Score"},l=void 0,o={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Formula and Computation",id:"formula-and-computation",level:2},{value:"Interpretation of Values",id:"interpretation-of-values",level:3},{value:"Key Findings",id:"key-findings",level:2},{value:"Interpretation",id:"interpretation",level:2},{value:"What CT can do",id:"what-ct-can-do",level:3},{value:"What CT cannot do (based on paper findings)",id:"what-ct-cannot-do-based-on-paper-findings",level:3},{value:"Reference",id:"reference",level:2}];function d(e){const n={a:"a",annotation:"annotation",br:"br",em:"em",h2:"h2",h3:"h3",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",munderover:"munderover",ol:"ol",p:"p",semantics:"semantics",span:"span",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsxs)(n.p,{children:["The CT Score was introduced in Exposing Flaws of Generative Model Evaluation Metrics and Their Unfair Treatment of Diffusion Models (Stein et al., 2023) as a three-sample non-parametric statistical test designed to detect memorization in generative models.",(0,t.jsx)(n.br,{}),"\n","Unlike metrics such as FID or IS, which primarily measure sample fidelity and diversity, the CT Score evaluates whether generated samples are disproportionately close to training samples compared to unseen test samples. If generated data lie closer to the training distribution than test data do, this may indicate that the model has memorized parts of its training set.\r\nThe CT Score is not a contrastive-learning metric; it is a distance-comparison hypothesis test based on Mann\u2013Whitney U-style rank statistics applied across many train/test/generated triplets."]}),"\n",(0,t.jsx)(n.h2,{id:"formula-and-computation",children:"Formula and Computation"}),"\n",(0,t.jsx)(n.p,{children:"Although the paper does not provide a single closed-form equation, the computation is explicitly described:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Embed training samples (",(0,t.jsx)(n.span,{className:"katex",children:(0,t.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(n.semantics,{children:[(0,t.jsx)(n.mrow,{children:(0,t.jsx)(n.mi,{children:"T"})}),(0,t.jsx)(n.annotation,{encoding:"application/x-tex",children:"T"})]})})}),"), test samples (",(0,t.jsx)(n.span,{className:"katex",children:(0,t.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(n.semantics,{children:[(0,t.jsx)(n.mrow,{children:(0,t.jsx)(n.mi,{children:"S"})}),(0,t.jsx)(n.annotation,{encoding:"application/x-tex",children:"S"})]})})}),"), and generated samples (",(0,t.jsx)(n.span,{className:"katex",children:(0,t.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(n.semantics,{children:[(0,t.jsx)(n.mrow,{children:(0,t.jsx)(n.mi,{children:"G"})}),(0,t.jsx)(n.annotation,{encoding:"application/x-tex",children:"G"})]})})}),") into a feature space."]}),"\n",(0,t.jsx)(n.li,{children:"Partition the embedded data into clusters (e.g., via k-means)."}),"\n",(0,t.jsxs)(n.li,{children:["For each cluster, compare the distances:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.span,{className:"katex",children:(0,t.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(n.semantics,{children:[(0,t.jsxs)(n.mrow,{children:[(0,t.jsx)(n.mi,{children:"d"}),(0,t.jsx)(n.mo,{stretchy:"false",children:"("}),(0,t.jsx)(n.mi,{children:"G"}),(0,t.jsx)(n.mo,{separator:"true",children:","}),(0,t.jsx)(n.mi,{children:"T"}),(0,t.jsx)(n.mo,{stretchy:"false",children:")"})]}),(0,t.jsx)(n.annotation,{encoding:"application/x-tex",children:"d(G, T)"})]})})})," \u2015 distance from generated \u2192 training"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.span,{className:"katex",children:(0,t.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(n.semantics,{children:[(0,t.jsxs)(n.mrow,{children:[(0,t.jsx)(n.mi,{children:"d"}),(0,t.jsx)(n.mo,{stretchy:"false",children:"("}),(0,t.jsx)(n.mi,{children:"S"}),(0,t.jsx)(n.mo,{separator:"true",children:","}),(0,t.jsx)(n.mi,{children:"T"}),(0,t.jsx)(n.mo,{stretchy:"false",children:")"})]}),(0,t.jsx)(n.annotation,{encoding:"application/x-tex",children:"d(S, T)"})]})})})," \u2015 distance from test \u2192 training"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Using a Mann\u2013Whitney U hypothesis test, compute how often:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"generated samples are closer to training samples than test samples are."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"A conceptual representation of the CT statistic for a cluster is:"}),"\n",(0,t.jsx)(n.span,{className:"katex",children:(0,t.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,t.jsxs)(n.semantics,{children:[(0,t.jsxs)(n.mrow,{children:[(0,t.jsx)(n.mi,{children:"C"}),(0,t.jsx)(n.mi,{children:"T"}),(0,t.jsx)(n.mo,{children:"="}),(0,t.jsxs)(n.mfrac,{children:[(0,t.jsx)(n.mn,{children:"1"}),(0,t.jsx)(n.mi,{children:"N"})]}),(0,t.jsxs)(n.munderover,{children:[(0,t.jsx)(n.mo,{children:"\u2211"}),(0,t.jsxs)(n.mrow,{children:[(0,t.jsx)(n.mi,{children:"i"}),(0,t.jsx)(n.mo,{children:"="}),(0,t.jsx)(n.mn,{children:"1"})]}),(0,t.jsx)(n.mi,{children:"N"})]}),(0,t.jsx)(n.mi,{mathvariant:"double-struck",children:"I"}),(0,t.jsx)(n.mo,{fence:"false",stretchy:"true",minsize:"1.2em",maxsize:"1.2em",children:"["}),(0,t.jsx)(n.mi,{children:"d"}),(0,t.jsx)(n.mo,{stretchy:"false",children:"("}),(0,t.jsxs)(n.msub,{children:[(0,t.jsx)(n.mi,{children:"G"}),(0,t.jsx)(n.mi,{children:"i"})]}),(0,t.jsx)(n.mo,{separator:"true",children:","}),(0,t.jsxs)(n.msub,{children:[(0,t.jsx)(n.mi,{children:"T"}),(0,t.jsx)(n.mi,{children:"i"})]}),(0,t.jsx)(n.mo,{stretchy:"false",children:")"}),(0,t.jsx)(n.mo,{children:"<"}),(0,t.jsx)(n.mi,{children:"d"}),(0,t.jsx)(n.mo,{stretchy:"false",children:"("}),(0,t.jsxs)(n.msub,{children:[(0,t.jsx)(n.mi,{children:"S"}),(0,t.jsx)(n.mi,{children:"i"})]}),(0,t.jsx)(n.mo,{separator:"true",children:","}),(0,t.jsxs)(n.msub,{children:[(0,t.jsx)(n.mi,{children:"T"}),(0,t.jsx)(n.mi,{children:"i"})]}),(0,t.jsx)(n.mo,{stretchy:"false",children:")"}),(0,t.jsx)(n.mo,{fence:"false",stretchy:"true",minsize:"1.2em",maxsize:"1.2em",children:"]"})]}),(0,t.jsx)(n.annotation,{encoding:"application/x-tex",children:"CT = \\frac{1}{N} \\sum_{i=1}^{N}\n\\mathbb{I}\\big[ d(G_i, T_i) < d(S_i, T_i) \\big]"})]})})}),"\n",(0,t.jsx)(n.p,{children:"where"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.span,{className:"katex",children:(0,t.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(n.semantics,{children:[(0,t.jsxs)(n.mrow,{children:[(0,t.jsx)(n.mi,{children:"d"}),(0,t.jsx)(n.mo,{stretchy:"false",children:"("}),(0,t.jsx)(n.mo,{children:"\u22c5"}),(0,t.jsx)(n.mo,{separator:"true",children:","}),(0,t.jsx)(n.mo,{children:"\u22c5"}),(0,t.jsx)(n.mo,{stretchy:"false",children:")"})]}),(0,t.jsx)(n.annotation,{encoding:"application/x-tex",children:"d(\\cdot,\\cdot)"})]})})})," is a distance in embedding space,"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.span,{className:"katex",children:(0,t.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(n.semantics,{children:[(0,t.jsx)(n.mrow,{children:(0,t.jsxs)(n.msub,{children:[(0,t.jsx)(n.mi,{children:"T"}),(0,t.jsx)(n.mi,{children:"i"})]})}),(0,t.jsx)(n.annotation,{encoding:"application/x-tex",children:"T_i"})]})})})," is a nearby training sample,"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.span,{className:"katex",children:(0,t.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(n.semantics,{children:[(0,t.jsx)(n.mrow,{children:(0,t.jsxs)(n.msub,{children:[(0,t.jsx)(n.mi,{children:"S"}),(0,t.jsx)(n.mi,{children:"i"})]})}),(0,t.jsx)(n.annotation,{encoding:"application/x-tex",children:"S_i"})]})})})," is a nearby test sample,"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.span,{className:"katex",children:(0,t.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(n.semantics,{children:[(0,t.jsxs)(n.mrow,{children:[(0,t.jsx)(n.mi,{mathvariant:"double-struck",children:"I"}),(0,t.jsx)(n.mo,{stretchy:"false",children:"["}),(0,t.jsx)(n.mo,{children:"\u22c5"}),(0,t.jsx)(n.mo,{stretchy:"false",children:"]"})]}),(0,t.jsx)(n.annotation,{encoding:"application/x-tex",children:"\\mathbb{I}[\\cdot]"})]})})})," is the indicator function."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The global CT Score is the average over all clusters."}),"\n",(0,t.jsx)(n.h3,{id:"interpretation-of-values",children:"Interpretation of Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"Positive CT"})," \u2192 generated samples are not unusually close to training data (no memorization)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"Negative CT"})," \u2192 generated samples are ",(0,t.jsx)(n.em,{children:"closer to training data"})," than test data are (possible memorization)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"Highly negative CT"})," \u2192 strong signal of memorization (or other confounding behaviors such as mode shrinkage)."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"key-findings",children:"Key Findings"}),"\n",(0,t.jsx)(n.p,{children:"Based strictly on Stein et al. (2023):"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The CT Score can detect strong memorization in controlled settings."}),"\n",(0,t.jsx)(n.li,{children:"However, it is not reliable as a general-purpose memorization metric."}),"\n",(0,t.jsx)(n.li,{children:"CT frequently confuses mode shrinkage with memorization, producing false positives."}),"\n",(0,t.jsx)(n.li,{children:"CT\u2019s behavior is influenced by image fidelity and representation artifacts, not just memorization."}),"\n",(0,t.jsx)(n.li,{children:"CT scores computed against the test set track closely with those computed against the training set, showing it is dominated by non-memorization factors."}),"\n",(0,t.jsx)(n.li,{children:"The authors propose a modified CT (CT\u2098) that swaps input roles, which mitigates some failures but still does not fully resolve reliability issues."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"In short, CT does not provide a robust or noise-free estimate of memorization."}),"\n",(0,t.jsx)(n.h2,{id:"interpretation",children:"Interpretation"}),"\n",(0,t.jsx)(n.p,{children:"The CT Score is best understood as a rank-based distance comparison test, not a contrastive or semantic metric."}),"\n",(0,t.jsx)(n.h3,{id:"what-ct-can-do",children:"What CT can do"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Identify extreme cases of memorization when the model directly reproduces training samples."}),"\n",(0,t.jsx)(n.li,{children:"Provide insight into how tightly generated samples cluster around training data."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"what-ct-cannot-do-based-on-paper-findings",children:"What CT cannot do (based on paper findings)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Reliably distinguish memorization from mode shrinkage, over-regularization, or fidelity differences."}),"\n",(0,t.jsx)(n.li,{children:"Provide a semantically meaningful quality score."}),"\n",(0,t.jsx)(n.li,{children:"Serve as a fair or reliable substitute for FID/IS."}),"\n",(0,t.jsx)(n.li,{children:"Offer a stable evaluation of diffusion models or any generative architecture."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The authors conclude that CT should be used with caution, and not as a standalone or definitive memorization metric."}),"\n",(0,t.jsx)(n.h2,{id:"reference",children:"Reference"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Stein, G., Cresswell, J. C., Hosseinzadeh, R., Sui, Y., Ross, B. L., Villecroze, V., Liu, Z., Caterini, A. L., Taylor, J. E. T., & Loaiza-Ganem, G. (2023).",(0,t.jsx)(n.br,{}),"\n","Exposing flaws of generative model evaluation metrics and their unfair treatment of diffusion models.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.a,{href:"https://doi.org/10.48550/arXiv.2306.04675",children:"https://doi.org/10.48550/arXiv.2306.04675"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>l});var s=i(6540);const t={},r=s.createContext(t);function a(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);